<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smooth Sync Scroll</title>
    <style>
        body {
            margin: 0;
            background-color: #121212;
            color: white;
            font-family: 'Helvetica Neue', sans-serif;
            /* Высота страницы = 2 экрана (200vh), чтобы было куда скроллить */
            height: 200vh; 
            overflow-x: hidden;
        }

        /* Контейнер модели. ФИКСИРОВАННЫЙ. */
        #model-wrapper {
            position: fixed;
            /* Центрируем точку отсчета (anchor point) по центру объекта */
            transform: translate(-50%, -50%); 
            /* Начальные значения (будут меняться скриптом) */
            top: 50%;      /* Всегда по центру вертикали */
            left: 75%;     /* Начало: Смещен вправо (75% ширины экрана) */
            width: 40vw;   /* Начало: Ширина 40% экрана */
            height: 60vh;  /* Начало: Высота 60% экрана */
            
            z-index: 10;
            pointer-events: auto; /* Чтобы работали клики и ховер */
        }

        model-viewer {
            width: 100%;
            height: 100%;
            background-color: transparent;
            outline: none;
        }

        /* ТЕКСТОВЫЕ БЛОКИ */
        .section {
            height: 100vh; /* Один экран */
            position: relative;
            z-index: 5;
            display: flex;
            align-items: center;
            padding-left: 10%;
            box-sizing: border-box;
            pointer-events: none; /* Чтобы текст пропускал клики сквозь пустые места */
        }
        
        .text-content {
            max-width: 400px;
            pointer-events: auto; /* Сам текст можно выделять */
        }

        h1 { margin: 0; font-size: 4rem; line-height: 1; }
        p { font-size: 1.2rem; color: #ccc; margin-top: 20px; }

    </style>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
</head>
<body>

    <div id="model-wrapper">
        <model-viewer 
            src="model.glb" 
            alt="3D Model" 
            camera-controls 
            shadow-intensity="1" 
            exposure="1"
            auto-rotate-delay="0" 
            rotation-per-second="30deg"
            disable-zoom> 
            </model-viewer>
    </div>

    <section class="section">
        <div class="text-content">
            <h1>START<br>HERE</h1>
            <p>
                1. Наведи мышку — модель вращается.<br>
                2. Кликни — запустится анимация.<br>
                3. Скролль вниз — плавное увеличение.
            </p>
        </div>
    </section>

    <section class="section">
        <div class="text-content" style="margin-top: auto; margin-bottom: 10%; background: rgba(0,0,0,0.8); padding: 20px; border-radius: 15px;">
            <h1>BIG<br>SCALE</h1>
            <p>Модель плавно приехала в центр и увеличилась, следуя за твоим скроллом.</p>
        </div>
    </section>

    <script>
        const wrapper = document.getElementById('model-wrapper');
        const viewer = document.querySelector('model-viewer');
        
        // --- НАСТРОЙКИ КООРДИНАТ ---
        // Start: Начальное положение (Справа)
        const startLeft = 75; // 75% от левого края
        const startWidth = 40; // 40vw ширина
        const startHeight = 60; // 60vh высота

        // End: Конечное положение (Центр)
        const endLeft = 50;   // 50% (Центр)
        const endWidth = 90;  // 90vw (Почти во всю ширину)
        const endHeight = 85; // 85vh

        // --- 1. ЛОГИКА СКРОЛЛА (МАТЕМАТИКА) ---
        window.addEventListener('scroll', () => {
            // Узнаем, сколько проскроллили (в пикселях)
            const scrolled = window.scrollY;
            // Высота одного экрана (это наш путь от начала до конца анимации)
            const maxScroll = window.innerHeight; 
            
            // Вычисляем прогресс от 0 до 1
            // Math.min(..., 1) означает, что больше 1 прогресс не уйдет
            let progress = scrolled / maxScroll;
            if (progress > 1) progress = 1;
            if (progress < 0) progress = 0;

            // ИНТЕРПОЛЯЦИЯ (Линейный переход значений)
            // Формула: Текущее = Начало + (Конец - Начало) * Прогресс
            
            const currentLeft = startLeft + (endLeft - startLeft) * progress;
            const currentWidth = startWidth + (endWidth - startWidth) * progress;
            const currentHeight = startHeight + (endHeight - startHeight) * progress;

            // Применяем стили мгновенно
            wrapper.style.left = currentLeft + '%';
            wrapper.style.width = currentWidth + 'vw';
            wrapper.style.height = currentHeight + 'vh';
        });

        // --- 2. ИСПРАВЛЕНИЕ ВРАЩЕНИЯ (HOVER) ---
        viewer.addEventListener('mouseenter', () => {
            viewer.autoRotate = true;
        });
        
        viewer.addEventListener('mouseleave', () => {
            viewer.autoRotate = false;
        });

        // --- 3. КЛИК И АНИМАЦИЯ ---
        viewer.addEventListener('load', () => {
            viewer.pause();      // Гарантированно стоим на паузе при загрузке
            viewer.currentTime = 0;
        });

        viewer.addEventListener('click', () => {
            if (viewer.paused) {
                viewer.play();
            } else {
                viewer.pause();
            }
        });

    </script>
</body>
</html>
